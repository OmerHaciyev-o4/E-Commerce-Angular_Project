{"ast":null,"code":"import { CookieService } from 'ngx-cookie-service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/auth/auth.service\";\nimport * as i2 from \"../product.service\";\nimport * as i3 from \"src/app/categories/category.service\";\nimport * as i4 from \"src/app/brands/brand.service\";\nimport * as i5 from \"src/app/colors/color.service\";\nimport * as i6 from \"@angular/router\";\nimport * as i7 from \"ngx-cookie-service\";\nimport * as i8 from \"src/app/services/alertify.service\";\nimport * as i9 from \"src/app/services/cloudinary.service\";\nimport * as i10 from \"@angular/common\";\nimport * as i11 from \"@angular/forms\";\nimport * as i12 from \"../../shared/preload/preload.component\";\n\nfunction ProductDetailsComponent_app_preload_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-preload\");\n  }\n}\n\nfunction ProductDetailsComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17)(1, \"div\", 18);\n    i0.ɵɵtext(2, \"Please click on the image to change the image.\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction ProductDetailsComponent_div_12_option_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 25);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const category_r7 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", category_r7.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(category_r7.name);\n  }\n}\n\nfunction ProductDetailsComponent_div_12_option_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 25);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const brand_r8 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", brand_r8.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(brand_r8.name);\n  }\n}\n\nfunction ProductDetailsComponent_div_12_option_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 25);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const color_r9 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", color_r9.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(color_r9.name);\n  }\n}\n\nfunction ProductDetailsComponent_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 19)(1, \"div\", 20)(2, \"select\", 21);\n    i0.ɵɵlistener(\"ngModelChange\", function ProductDetailsComponent_div_12_Template_select_ngModelChange_2_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.product.categoryId = $event);\n    });\n    i0.ɵɵtemplate(3, ProductDetailsComponent_div_12_option_3_Template, 2, 2, \"option\", 22);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"div\", 20)(5, \"select\", 23);\n    i0.ɵɵlistener(\"ngModelChange\", function ProductDetailsComponent_div_12_Template_select_ngModelChange_5_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.product.brandId = $event);\n    });\n    i0.ɵɵtemplate(6, ProductDetailsComponent_div_12_option_6_Template, 2, 2, \"option\", 22);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 20)(8, \"select\", 24);\n    i0.ɵɵlistener(\"ngModelChange\", function ProductDetailsComponent_div_12_Template_select_ngModelChange_8_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.product.colorId = $event);\n    });\n    i0.ɵɵtemplate(9, ProductDetailsComponent_div_12_option_9_Template, 2, 2, \"option\", 22);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", ctx_r2.product.categoryId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.categories);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", ctx_r2.product.brandId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.brands);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", ctx_r2.product.colorId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.colors);\n  }\n}\n\nfunction ProductDetailsComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 26)(1, \"div\", 27)(2, \"label\", 28)(3, \"input\", 29);\n    i0.ɵɵlistener(\"ngModelChange\", function ProductDetailsComponent_div_13_Template_input_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.product.newItem = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \" New Item\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 30)(6, \"label\", 31);\n    i0.ɵɵtext(7, \" Count: \");\n    i0.ɵɵelementStart(8, \"input\", 32);\n    i0.ɵɵlistener(\"ngModelChange\", function ProductDetailsComponent_div_13_Template_input_ngModelChange_8_listener($event) {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r16.product.count = $event);\n    });\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r3.product.newItem);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r3.product.count);\n  }\n}\n\nexport let ProductDetailsComponent = /*#__PURE__*/(() => {\n  class ProductDetailsComponent {\n    constructor(authService, productService, categoryService, brandService, colorService, activatedRouted, cookieService, alertifyService, cloudinaryService, router) {\n      this.authService = authService;\n      this.productService = productService;\n      this.categoryService = categoryService;\n      this.brandService = brandService;\n      this.colorService = colorService;\n      this.activatedRouted = activatedRouted;\n      this.cookieService = cookieService;\n      this.alertifyService = alertifyService;\n      this.cloudinaryService = cloudinaryService;\n      this.router = router;\n      this.preload = true;\n      this.selectedImageFile = null;\n      this.rowCount = 1;\n      this.selectedCount = 1;\n      this.isVisible = true;\n    }\n\n    ngOnInit() {\n      this.activatedRouted.params.subscribe(params => {\n        this.productService.getProductById(params[\"productId\"]).subscribe(product => {\n          this.productBase = { ...product\n          };\n          this.product = product;\n\n          for (let i = 0; i < product.description.length; i++) {\n            const character = product.description[i];\n            if (character == '\\n') this.rowCount++;\n          }\n\n          this.preload = false;\n        });\n        this.categoryService.getCategories().subscribe(response => {\n          this.categories = response;\n        });\n        this.brandService.getBrands().subscribe(response => {\n          this.brands = response;\n        });\n        this.colorService.getColors().subscribe(response => {\n          this.colors = response;\n        });\n      });\n      this.authService.userBase.subscribe(userBase => {\n        if (userBase) {\n          this.isAuthenticated = userBase.role == \"admin\" ? true : false;\n          this.GMAIL = userBase.email;\n        }\n      });\n    }\n\n    selectImage(event) {\n      this.selectedImageFile = event.target.files[0];\n      var img = document.getElementById('proImg');\n      img.src = URL.createObjectURL(this.selectedImageFile);\n    }\n\n    openFiles() {\n      document.getElementById('imageUrl').click();\n    }\n\n    addToCard() {\n      var allCards = this.cookieService.check(`${this.GMAIL}cards`) ? JSON.parse(this.cookieService.get(`${this.GMAIL}cards`)) : null;\n\n      if (allCards) {\n        var index = -1;\n\n        for (let i = 0; i < allCards.length; i++) {\n          const card = allCards[i];\n\n          if (card.id == this.product.id) {\n            index = i;\n            break;\n          }\n        }\n\n        index >= 0 ? allCards[index].count++ : allCards.push(this.addNewCard());\n      } else {\n        allCards = [];\n        allCards.push(this.addNewCard());\n      }\n\n      this.cookieService.delete(`${this.GMAIL}cards`);\n      this.cookieService.set(`${this.GMAIL}cards`, JSON.stringify(allCards));\n      this.alertifyService.success(this.product.name + ' added successfully.');\n    }\n\n    addNewCard() {\n      return {\n        id: this.product.id,\n        product: this.product,\n        count: 1\n      };\n    }\n\n    changeMode() {\n      this.isVisible = !this.isVisible;\n      const inputs = ['name', 'description', 'price'];\n      inputs.forEach(inp => {\n        var vrb = document.getElementById(inp);\n        this.isVisible ? vrb.setAttribute('readonly', 'readonly') : vrb.removeAttribute('readonly');\n      });\n\n      if (this.isVisible) {\n        this.updateProduct();\n      }\n    }\n\n    productUpdateBridge() {\n      this.product.publishedDate = new Date();\n      this.productService.updateProduct(this.product).subscribe(data => {\n        this.preload = false;\n        setTimeout(() => {\n          this.alertifyService.warning(`${this.product.name} update successfully.`);\n        }, 50);\n      });\n    }\n\n    updateProduct() {\n      var result = this.selectedImageFile ? true : false;\n      this.preload = true;\n\n      if (result) {\n        var formData = new FormData();\n        formData.append('file', this.selectedImageFile);\n        formData.append('upload_preset', 'uw_angular');\n        formData.append('cloud_name', 'social-network-web');\n        this.cloudinaryService.uploadImage(formData).subscribe(response => {\n          this.product.imageUrl = response.secure_url;\n          this.productUpdateBridge();\n        });\n      } else if (JSON.stringify(this.product) != JSON.stringify(this.productBase) ? true : false) {\n        this.productUpdateBridge();\n      } else this.preload = false;\n    }\n\n    deleteProduct() {\n      this.productService.deleteProduct(this.product.id).subscribe(response => {\n        this.router.navigate(['/products']);\n      });\n    }\n\n  }\n\n  ProductDetailsComponent.ɵfac = function ProductDetailsComponent_Factory(t) {\n    return new (t || ProductDetailsComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.ProductService), i0.ɵɵdirectiveInject(i3.CategoryService), i0.ɵɵdirectiveInject(i4.BrandService), i0.ɵɵdirectiveInject(i5.ColorService), i0.ɵɵdirectiveInject(i6.ActivatedRoute), i0.ɵɵdirectiveInject(i7.CookieService), i0.ɵɵdirectiveInject(i8.AlertifyService), i0.ɵɵdirectiveInject(i9.CloudinaryService), i0.ɵɵdirectiveInject(i6.Router));\n  };\n\n  ProductDetailsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProductDetailsComponent,\n    selectors: [[\"app-product-details\"]],\n    features: [i0.ɵɵProvidersFeature([CookieService])],\n    decls: 21,\n    vars: 28,\n    consts: [[4, \"ngIf\"], [\"class\", \"row mx-2 mt-3\", 4, \"ngIf\"], [1, \"row\", \"mt-3\", \"mb-3\"], [1, \"col-md-3\", \"ml-auto\", \"m-0\"], [\"id\", \"proImg\", 2, \"height\", \"25rem\", 3, \"src\", \"click\"], [1, \"col-md-5\", \"mr-auto\", \"m-0\", \"bg-dark\", \"rounded-right\", \"position-relative\"], [\"type\", \"file\", \"name\", \"imageUrl\", \"id\", \"imageUrl\", \"accept\", \"image/*\", 1, \"d-none\", 3, \"change\"], [\"readonly\", \"\", \"maxlength\", \"25\", \"type\", \"text\", \"id\", \"name\", 1, \"h4\", \"mt-3\", \"ml-2\", \"base-style\", 3, \"ngModel\", \"ngModelChange\"], [\"id\", \"description\", \"cols\", \"30\", \"readonly\", \"\", \"id\", \"description\", 1, \"mt-3\", \"ml-2\", \"base-style\", 3, \"rows\", \"ngModel\", \"ngModelChange\"], [1, \"h5\", \"text-light\", \"mt-4\", \"ml-2\"], [\"readonly\", \"\", \"min\", \"1\", \"type\", \"number\", \"id\", \"price\", \"pattern\", \"[0-9]*\", 1, \"w-auto\", \"base-style\", 3, \"ngModel\", \"ngModelChange\"], [\"class\", \"row w-100 px-3 mt-3\", 4, \"ngIf\"], [\"class\", \"row mt-3\", 4, \"ngIf\"], [1, \"row\", \"w-100\", \"m-0\", \"position-absolute\", \"buttons-style\"], [1, \"btn\", \"btn-success\", \"col-md-3\", \"mx-auto\", \"add-to-card-style\", 3, \"click\"], [1, \"btn\", \"btn-dark\", \"col-md-3\", \"mx-auto\", \"add-to-card-style\", 3, \"click\"], [1, \"btn\", \"btn-dark\", \"col-md-3\", \"mx-auto\", \"add-to-card-style\", \"delete-style\", 3, \"click\"], [1, \"row\", \"mx-2\", \"mt-3\"], [1, \"col-md-12\", \"alert\", \"alert-warning\"], [1, \"row\", \"w-100\", \"px-3\", \"mt-3\"], [1, \"col-md-4\"], [\"name\", \"categoryId\", 1, \"w-100\", \"p-1\", 3, \"ngModel\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"name\", \"brandId\", 1, \"w-100\", \"p-1\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"colorId\", 1, \"w-100\", \"p-1\", 3, \"ngModel\", \"ngModelChange\"], [3, \"value\"], [1, \"row\", \"mt-3\"], [1, \"col-md-3\"], [1, \"text-light\"], [\"type\", \"checkbox\", \"name\", \"newItem\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-md-5\", \"text-light\"], [\"for\", \"count\"], [\"type\", \"number\", \"min\", \"1\", \"pattern\", \"[0-9]*\", \"name\", \"count\", \"id\", \"count\", 3, \"ngModel\", \"ngModelChange\"]],\n    template: function ProductDetailsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, ProductDetailsComponent_app_preload_0_Template, 1, 0, \"app-preload\", 0);\n        i0.ɵɵtemplate(1, ProductDetailsComponent_div_1_Template, 3, 0, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2)(3, \"div\", 3)(4, \"img\", 4);\n        i0.ɵɵlistener(\"click\", function ProductDetailsComponent_Template_img_click_4_listener() {\n          return !ctx.isVisible == true ? ctx.openFiles() : \"\";\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(5, \"div\", 5)(6, \"input\", 6);\n        i0.ɵɵlistener(\"change\", function ProductDetailsComponent_Template_input_change_6_listener($event) {\n          return ctx.selectImage($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"input\", 7);\n        i0.ɵɵlistener(\"ngModelChange\", function ProductDetailsComponent_Template_input_ngModelChange_7_listener($event) {\n          return ctx.product.name = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"textarea\", 8);\n        i0.ɵɵlistener(\"ngModelChange\", function ProductDetailsComponent_Template_textarea_ngModelChange_8_listener($event) {\n          return ctx.product.description = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"label\", 9);\n        i0.ɵɵtext(10, \"Price: $ \");\n        i0.ɵɵelementStart(11, \"input\", 10);\n        i0.ɵɵlistener(\"ngModelChange\", function ProductDetailsComponent_Template_input_ngModelChange_11_listener($event) {\n          return ctx.product.price = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(12, ProductDetailsComponent_div_12_Template, 10, 6, \"div\", 11);\n        i0.ɵɵtemplate(13, ProductDetailsComponent_div_13_Template, 9, 2, \"div\", 12);\n        i0.ɵɵelementStart(14, \"div\", 13)(15, \"button\", 14);\n        i0.ɵɵlistener(\"click\", function ProductDetailsComponent_Template_button_click_15_listener() {\n          return ctx.addToCard();\n        });\n        i0.ɵɵtext(16, \"Add To Card\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"button\", 15);\n        i0.ɵɵlistener(\"click\", function ProductDetailsComponent_Template_button_click_17_listener() {\n          return ctx.changeMode();\n        });\n        i0.ɵɵtext(18);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"button\", 16);\n        i0.ɵɵlistener(\"click\", function ProductDetailsComponent_Template_button_click_19_listener() {\n          return ctx.deleteProduct();\n        });\n        i0.ɵɵtext(20, \"Delete\");\n        i0.ɵɵelementEnd()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.preload);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isAuthenticated && !ctx.isVisible);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"src\", ctx.product.imageUrl, i0.ɵɵsanitizeUrl);\n        i0.ɵɵadvance(3);\n        i0.ɵɵclassProp(\"no-admin-pro-name\", ctx.isVisible)(\"text-light\", ctx.isVisible);\n        i0.ɵɵproperty(\"ngModel\", ctx.product.name);\n        i0.ɵɵadvance(1);\n        i0.ɵɵclassProp(\"no-admin-pro-desc\", ctx.isVisible)(\"text-light\", ctx.isVisible);\n        i0.ɵɵproperty(\"rows\", ctx.rowCount)(\"ngModel\", ctx.product.description);\n        i0.ɵɵadvance(3);\n        i0.ɵɵclassProp(\"no-admin-pro-price\", ctx.isVisible)(\"text-danger\", ctx.isVisible);\n        i0.ɵɵproperty(\"ngModel\", ctx.product.price);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isVisible);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isVisible);\n        i0.ɵɵadvance(2);\n        i0.ɵɵclassProp(\"d-none\", ctx.isAuthenticated);\n        i0.ɵɵadvance(2);\n        i0.ɵɵclassProp(\"d-none\", !ctx.isAuthenticated);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.isVisible ? \"Change Mode\" : \"Save Mode\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵclassProp(\"d-none\", !ctx.isAuthenticated || !ctx.isVisible);\n      }\n    },\n    dependencies: [i10.NgForOf, i10.NgIf, i11.NgSelectOption, i11.ɵNgSelectMultipleOption, i11.DefaultValueAccessor, i11.NumberValueAccessor, i11.CheckboxControlValueAccessor, i11.SelectControlValueAccessor, i11.NgControlStatus, i11.MaxLengthValidator, i11.PatternValidator, i11.MinValidator, i11.NgModel, i12.PreloadComponent],\n    styles: [\".base-style[_ngcontent-%COMP%]{width:100%;text-align:justify;border:0;-webkit-appearance:textfield}.no-admin-pro-name[_ngcontent-%COMP%]{background-color:transparent;outline:none;cursor:context-menu}.no-admin-pro-desc[_ngcontent-%COMP%]{background-color:transparent;outline:none;cursor:context-menu;resize:none}.no-admin-pro-price[_ngcontent-%COMP%]{outline:none;cursor:context-menu;background-color:transparent}.buttons-style[_ngcontent-%COMP%]{left:50%;transform:translate(-50%);bottom:10px!important}.add-to-card-style[_ngcontent-%COMP%]{border:1px solid white;background-color:transparent;transition:.8s}.add-to-card-style[_ngcontent-%COMP%]:hover{background:white!important;border:1px solid black;color:#000;transition:.8s}.delete-style[_ngcontent-%COMP%]:hover{background:red!important;border-color:#fff!important;color:#fff;transition:.8s}\"]\n  });\n  return ProductDetailsComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}